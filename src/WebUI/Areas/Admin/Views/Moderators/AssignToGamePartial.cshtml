@using CleanArchitecture.Application.Requests.Games.Models
@model IEnumerable<CleanArchitecture.Application.Requests.Games.Models.GameVm>

<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

@if (Model.Any())
{
    <form method="post" asp-area="Admin" asp-controller="Moderators" asp-action="AssignToGamePartial" asp-route-id="@Context.Request.RouteValues["id"]">
        <div class="row">

            <div class="col-12">
                <div class="mb-3">
                    <label for="game" class="form-label">Select Games </label>
             
                    <select class="gameList" name="gameIds"  multiple="multiple">
                     
                        @foreach(var game in Model)
                        {
                            if (((List<GameVm>)ViewBag.assignedGames).Any(x=>x.Id == game.Id))
                            {

                                <option selected value="@game.Id">@game.Name</option>

                            }
                            else
                            {
                                
                            <option value="@game.Id">@game.Name</option>
                            }

                        }
                       

                    </select>
                </div>
            </div><!--end col-->
            <div class="col-lg-12 mb-4">
                <div class="text-end">
                    <button type="submit" class="btn btn-primary">Assign To Games </button>

                </div>
                <!-- Warning Alert -->
                <div class="alert alert-warning mt-4" role="alert">
                    <b>Warning .. Please Note that if there if assigned moderator to game you will remove his and assign this moderator  </b> 
                </div>

            </div><!--end col-->
        </div><!--end row-->
    </form>
    
   
}
else
{
    <!-- Danger Alert -->
    <div class="alert alert-danger alert-dismissible alert-additional fade show" style="margin: 3rem" role="alert">
        <div class="alert-body">
            <div class="d-flex">
                <div class="flex-shrink-0 me-3">
                    <i class="ri-error-warning-line fs-16 align-middle"></i>
                </div>
                <div class="flex-grow-1">
                    <h5 class="alert-heading">No Moderators</h5>
                    <p class="mb-0">No Games Found in the system</p>
                </div>
            </div>
        </div>
        <div class="alert-content mt-4">
            <p class="mb-0">Please create game than assign it to the game </p>
        </div>
    </div>
}

<script>
   
        $('.gameList').select2({
            dropdownParent: $('#generalModal')
        });

        $('.gameList').on("select2:unselect", function (e) {
        if (!e.params.originalEvent) {
            return
        }

        e.params.originalEvent.stopPropagation();
    });
    
</script>